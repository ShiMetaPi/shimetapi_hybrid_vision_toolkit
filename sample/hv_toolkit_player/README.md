# HV Toolkit Player Demo

## 功能概述

`hv_toolkit_player` 是一个事件数据播放器，基于Metavision SDK开发，用于播放和可视化HV相机录制的二进制raw事件文件。该播放器提供了实时的事件数据可视化功能，支持暂停、重播和速度控制，是分析和调试事件数据的重要工具。

## 使用方法

### 编译

```bash
# 进入项目目录
cd hv_toolkit_player

# 使用CMake编译
mkdir build && cd build
cmake ..
make

### 运行

```bash
# 基本用法
./hv_toolkit_player <事件文件.sraw>

# 示例
./hv_toolkit_player recording_20240101.raw
./hv_toolkit_player events.raw
```

### 参数说明

- `<事件文件.raw>`: 输入的HV相机录制的raw事件文件路径（必需）

### 操作控制

- **ESC键**: 退出播放器
- **Q键**: 退出播放器
- **Ctrl+C**: 强制退出程序
- **关闭窗口**: 点击窗口关闭按钮退出

## 输出信息

### 启动信息
```
文件信息:
  分辨率: 768x608
  事件数量: 0
  时长: 0 秒
```

### 播放状态
- 实时显示事件数据的可视化图像
- 播放结束后显示"press the Q key to exit"提示
- 程序退出时显示"程序已退出"

### 播放流程

1. **文件打开**: 使用HVEventReader打开raw文件
2. **信息获取**: 读取文件分辨率和时间戳信息
3. **帧生成器初始化**: 创建周期性帧生成算法实例
4. **播放线程启动**: 在独立线程中开始事件读取和处理
5. **实时显示**: 主线程负责图像显示和用户交互
6. **资源清理**: 播放结束后清理所有资源

## 配置参数

### 帧生成参数
- **累积时间**: 50ms（50000微秒）
- **帧率**: 20 FPS
- **批量大小**: 10000个事件
- **播放速度**: 1.0倍速

### 显示参数
- **窗口类型**: WINDOW_AUTOSIZE（自动调整大小）
- **刷新间隔**: 1ms（cv::waitKey(1)）
- **字体**: FONT_HERSHEY_SIMPLEX

## 依赖要求

### 必需依赖
- **Metavision SDK**: 用于事件数据处理和帧生成
- **OpenCV**: 用于图像显示和处理
- **HV Event Reader**: HV相机事件读取库
- **C++11**: 支持现代C++特性
- **CMake**: 3.10或更高版本

### 系统要求
- **操作系统**: Linux, Windows, macOS
- **内存**: 至少4GB可用内存
- **显示**: 支持OpenCV图像显示的环境
- **编译器**: GCC 7.0+, Clang 6.0+, 或 MSVC 2017+

## 注意事项

1. **文件格式**: 确保输入文件是HV相机录制的标准raw格式
2. **内存使用**: 大文件播放可能需要较多内存
3. **显示性能**: 播放性能取决于系统的图形处理能力
4. **文件完整性**: 确保raw文件完整且未损坏
5. **依赖安装**: 确保所有依赖库正确安装和配置

## 故障排除

### 常见问题

1. **"无法打开事件文件"错误**
   - 检查文件路径是否正确
   - 确认文件存在且有读取权限
   - 验证文件格式是否为HV相机raw格式

2. **显示窗口无法创建**
   - 检查是否安装了OpenCV
   - 确认系统支持图形界面
   - 验证X11转发（Linux远程连接时）

3. **播放卡顿或延迟**
   - 检查系统CPU和内存使用情况
   - 调整批量读取大小
   - 考虑降低帧率或累积时间

4. **编译错误**
   - 检查Metavision SDK是否正确安装
   - 验证所有头文件路径
   - 确认链接库是否正确
